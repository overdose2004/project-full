<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index3.css">
    <title>หมวดหมู่สินค้า</title>
</head>
<body>

    <div id="navbar-placeholder"></div>
    <script src="/index/navbar.js"></script>

    <h1>หมวดหมู่สินค้า</h1>

    <div class="category">
        <div class="product-list">
            <div class="product">
                <img src="/index3/pix/Screenshot 2025-02-07 191759.png" alt="แม็ก">
                <h3>แม็ก</h3>
                <p>ราคา: 3,000 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/Screenshot 2025-02-07 191536.png" alt="แม็ก">
                <h3>แม็ก</h3>
                <p>ราคา: 3,000บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/แม็ก3.png" alt="แม็ก">
                <h3>แม็ก</h3>
                <p>ราคา: 3,000บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/แม็ก4.png" alt="แม็ก">
                <h3>แม็ก</h3>
                <p>ราคา: 3,000บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/แม็ก5.png" alt="แม็ก">
                <h3>แม็ก</h3>
                <p>ราคา: 3,000บาท</p>
                <button class="button">Add to cart</button>
            </div>
        </div>
    </div>

    <div class="category">
        <div class="product-list">
            <div class="product">
                <img src="/index3/pix/กันกระแทก.png" alt="กันกระแทก">
                <h3>กันกระแทก</h3>
                <p>ราคา: 400 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/โช๊ค.jpg" alt="โช็ค">
                <h3>โช็ค</h3>
                <p>ราคา: 2,000 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/แผ่นรองขาตั้ง.jpg" alt="แผ่นรองขาตั้ง">
                <h3>แผ่นรองขาตั้ง</h3>
                <p>ราคา: 250 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/มือคลัทช์.jpg" alt="มือคลัทช์">
                <h3>มือคลัทช์</h3>
                <p>ราคา: 1,000 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/ฝาครอบถังน้ำมัน.jpg" alt="ฝาครอบถังน้ำมัน">
                <h3>ฝาครอบถังน้ำมัน</h3>
                <p>ราคา: 500 บาท</p>
                <button class="button">Add to cart</button>
            </div>
        </div>
    </div>

    <div class="category">
        <div class="product-list">
            <div class="product">
                <img src="/index3/pix/ชุดเชื่อม.jpg" alt="ชุดเชื่อม">
                <h3>ชุดเชื่อม</h3>
                <p>ราคา: 700 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/ชุดมือเบรค.jpg" alt="ชุดมือเบรค">
                <h3>ชุดมือเบรค</h3>
                <p>ราคา: 2,500 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/ชุดท้ายสั้น.jpg" alt="ชุดท้ายสั้น">
                <h3>ชุดท้ายสั้น</h3>
                <p>ราคา: 800 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/ชุดการ์ดแฮนด์ซ้าย ขวา.jpg" alt="ชุดการ์ดแฮนด์ซ้าย ขวา">
                <h3>ชุดการ์ดแฮนด์ซ้าย ขวา</h3>
                <p>ราคา: 300 บาท</p>
                <button class="button">Add to cart</button>
            </div>
            <div class="product">
                <img src="/index3/pix/จานเบรค.jpg" alt="จานเบรค">
                <h3>จานเบรค</h3>
                <p>ราคา: 550 บาท</p>
                <button class="button">Add to cart</button>
            </div>
        </div>
    </div>

    <!-- ป๊อบอัพ -->
    <div class="overlay" id="overlay"></div>
    <div class="popup" id="popup">
        <h2>สินค้าได้ถูกเพิ่มลงในตะกร้า</h2>
        <div id="popup-content">
            <!-- ข้อมูลสินค้าที่เพิ่มไปยังตะกร้า -->
        </div>
        <div id="popup-quantity">
            <button class="decrease">-</button>
            <span id="product-quantity">1</span>
            <button class="increase">+</button>
        </div>
        <div id="popup-actions">
            <button id="confirm-btn" class="confirm">ยืนยัน</button>
            <button id="cancel-btn" class="cancel">ยกเลิก</button>
        </div>
        <button class="close-btn" onclick="closePopup()">ปิด</button>
    </div>

    <script>
        let currentProduct = null;

        // ฟังก์ชันเปิดป๊อบอัพ
        function openPopup(product) {
            currentProduct = product;
            document.getElementById('popup').style.display = 'block';
            document.getElementById('overlay').style.display = 'block';

            // อัปเดตข้อมูลในป๊อบอัพ
            const popupContent = document.getElementById('popup-content');
            popupContent.innerHTML = `
                <img src="${product.image}" alt="${product.name}" style="width: 100px; height: 100px;">
                <h3>${product.name}</h3>
                <p>${product.price}</p>
            `;

            // เก็บจำนวนสินค้าไว้
            document.getElementById('product-quantity').innerText = product.quantity;

            // สร้างปุ่มเพิ่มและลดจำนวน
            document.querySelector('.increase').addEventListener('click', () => updateQuantity(1));
            document.querySelector('.decrease').addEventListener('click', () => updateQuantity(-1));

            // เพิ่มเหตุการณ์ให้ปุ่มยืนยันและยกเลิก
            document.getElementById('confirm-btn').addEventListener('click', confirmAddToCart);
            document.getElementById('cancel-btn').addEventListener('click', closePopup);
        }

        // ฟังก์ชันปิดป๊อบอัพ
        function closePopup() {
            document.getElementById('popup').style.display = 'none';
            document.getElementById('overlay').style.display = 'none';
        }

        // ฟังก์ชันอัปเดตจำนวนสินค้า
        function updateQuantity(delta) {
            const quantityElement = document.getElementById('product-quantity');
            let quantity = parseInt(quantityElement.innerText);
            quantity += delta;
            if (quantity < 1) {
                quantity = 1;
            }
            quantityElement.innerText = quantity;

            // อัปเดตจำนวนสินค้าในป๊อบอัพ
            currentProduct.quantity = quantity;
        }

        // ฟังก์ชันยืนยันการเพิ่มสินค้าในตะกร้า
        function confirmAddToCart() {
            // โหลดตะกร้าสินค้าจาก LocalStorage
            let cart = JSON.parse(localStorage.getItem('cart')) || [];

            // ค้นหาสินค้าในตะกร้า
            const productIndex = cart.findIndex(item => item.name === currentProduct.name);

            if (productIndex !== -1) {
                // หากพบสินค้าซ้ำในตะกร้า อัปเดตจำนวนสินค้า
                cart[productIndex].quantity = currentProduct.quantity;
            } else {
                // หากไม่พบสินค้าในตะกร้า ให้เพิ่มสินค้าใหม่
                cart.push(currentProduct);
            }

            // บันทึกตะกร้าสินค้าใน LocalStorage
            localStorage.setItem('cart', JSON.stringify(cart));

            // ปิดป๊อบอัพ
            closePopup();

            // แจ้งเตือนการเพิ่มสินค้า
            alert(`${currentProduct.name} ถูกเพิ่มลงในตะกร้าแล้ว`);
        }

        // เพิ่มสินค้าไปยังตะกร้า
        document.querySelectorAll('.button').forEach(button => {
            button.addEventListener('click', (event) => {
                const button = event.target;
                const productElement = button.closest('.product');
                const productName = productElement.querySelector('h3').innerText;
                const productPrice = productElement.querySelector('p').innerText;
                const productImage = productElement.querySelector('img').src;

                // สร้างอ็อบเจ็กต์สินค้า
                const product = {
                    name: productName,
                    price: productPrice,
                    image: productImage,
                    quantity: 1 // กำหนดจำนวนสินค้าเริ่มต้นเป็น 1
                };

                // เปิดป๊อบอัพ
                openPopup(product);
            });
        });
    </script>

</body>
</html>
